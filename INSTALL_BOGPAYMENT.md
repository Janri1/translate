# Инструкция по установке и настройке модуля BogPayments для OpenCart

## 1. Копирование файлов

Скопируйте файлы модуля в соответствующие директории вашего магазина:
- Контроллер: `catalog/controller/extension/payment/bogpayment.php`
- Модель: `catalog/model/extension/payment/bogpayment.php`
- Шаблон витрины: `catalog/view/theme/default/template/extension/payment/bogpayment.twig`
- Языковые файлы:
    - `admin/language/ru-ru/extension/payment/bogpayment.php`
    - `admin/language/en-gb/extension/payment/bogpayment.php`
    - `admin/language/ge-ka/extension/payment/bogpayment.php`
    - `catalog/language/ru-ru/extension/payment/bogpayment.php`
    - `catalog/language/en-gb/extension/payment/bogpayment.php`
    - `catalog/language/ge-ka/extension/payment/bogpayment.php`
- Twig-шаблон админки: `admin/view/template/extension/payment/bogpayment.twig`

## 2. Включение модуля

1. Перейдите в админ-панель OpenCart: **Модули → Оплата → BogPayments**.
2. Нажмите "Установить".
3. Откройте страницу настроек модуля.

## 3. Настройка параметров

- **API Bearer Token** — получите в интернет-банке BOG или у службы поддержки банка.
- **Тестовый режим** — используйте для тестовой среды (при необходимости).
- **Статус модуля** — включить/отключить модуль.

### Статусы заказа

Укажите соответствие статусов заказа для каждого состояния от банка:
- **Ожидание (pending)** — заказ ожидает оплаты.
- **Авторизован (authorized)** — платёж авторизован, но не списан.
- **Успех (completed)** — платёж завершён, средства списаны.
- **Ошибка (failed)** — платёж не прошёл.
- **Отменён (cancelled)** — платёж отменён.
- **Истёк (expired)** — время оплаты истекло.

> **Важно!**  
> Все статусы должны быть корректно выбраны для правильной работы автоматической смены статусов заказа.

## 4. Проверка работы

1. Оформите тестовый заказ с выбором BogPayments.
2. Проверьте, что происходит переход на страницу оплаты BOG.
3. После успешной или неуспешной оплаты проверьте, что статус заказа обновляется автоматически.
4. Все события, ошибки, ответы от банка логируются в файл: `system/storage/logs/bogpayment.log`.

## 5. Просмотр логов

- Откройте файл `system/storage/logs/bogpayment.log` для анализа ошибок, событий и callback.

## 6. Примечания

- Для работы необходим включённый PHP-расширение **cURL**.
- Bearer Token должен быть актуальным.
- Callback-URL должен быть доступен для банка BOG (настройте HTTPS).
- При изменении структуры магазина или обновлении OpenCart — проверьте совместимость модуля.

## 7. Тестовые статусы BOG API

| Статус банка    | Что значит                 | Какой статус заказа выбрать      |
|-----------------|---------------------------|----------------------------------|
| pending         | Ожидание оплаты           | Ожидание                        |
| authorized      | Платёж авторизован        | Авторизован                     |
| completed       | Платёж завершён           | Оплачен                         |
| failed          | Платёж не прошёл          | Ошибка                          |
| cancelled       | Платёж отменён            | Отменён                         |
| expired         | Время оплаты истекло      | Истёк                           |

---

## 8. FAQ (Часто задаваемые вопросы)

**1. Как получить Bearer Token для интеграции?**  
Обратитесь в ваш банк BOG или используйте онлайн-кабинет для генерации токена.

**2. Почему не меняется статус заказа?**  
Проверьте:
- Корректность настроек статусов в админке.
- Доступность callback-URL для банка (наличие HTTPS).
- Логи в `bogpayment.log`.

**3. Где посмотреть ошибки или события модуля?**  
В файле `system/storage/logs/bogpayment.log`.

**4. Что делать, если модуль не появился в списке платежей?**  
- Проверьте корректность установки файлов.
- Очистите кэш OpenCart.

**5. Как включить тестовый режим?**  
В настройках модуля выберите "Тестовый режим" — платежи будут проводиться на тестовой среде банка (если поддерживается банком).

**6. Какие PHP-расширения нужны для работы?**  
Требуется расширение **cURL**.

**7. Можно ли использовать модуль для нескольких языков?**  
Да, предусмотрены языковые файлы: русский, английский, грузинский.

**8. Модуль не работает после обновления OpenCart**  
Проверьте совместимость версии модуля и OpenCart. При необходимости обратитесь к разработчику.

---

**Если возникают ошибки или вопросы — проверьте лог-файл и напишите в поддержку.**

Добавлена инструкция по установке BogPayments.
